# Default values: 'https://github.com/sxyazi/yazi/blob/shipped/yazi-config/preset/yazi-default.toml'
# Path:
#   ~/.config/yazi/yazi.toml        (Unix-like systems)
#   %AppData%\yazi\config\yazi.toml (Windows)
#
# A TOML linter such as https://taplo.tamasfe.dev/ can use this schema to validate your config.
"$schema" = "https://yazi-rs.github.io/schemas/yazi.json"

[opener]
open_folder = [
    # Para Windows
	{ run = 'cmd /c "%USERPROFILE%\.files\shell\cmd\bin\cmds\open_new_termtab.cmd" %1', desc = "Open in TermTab", for = "windows" },
	#{ run = 'wezterm cli spawn --cwd %1', desc = "Open in Wezterm tab", for = "windows" },
	{ run = 'explorer /select,%1', desc = "Open in Explorer", for = "windows", orphan = true },
	{ run = 'code %1', desc = "Open with VSCode", for = "windows", orphan = true },

    # Para Android (Termux)
    # Para MacOS

    # Para Linux y Unix
	{ run = '${HOME}/.local/bin/open_new_termtab "$1"', desc = "Open in TermTab", for = "linux" },
	{ run = 'nautilus --select "$1" &', desc = "Open in Explorer", for = "linux", orphan = true },
	{ run = 'code "$1"', desc = "Open with VSCode", for = "unix", orphan = true },
]

open_file = [
    # Para Windows
	{ run = 'start "" %1', desc = "Open by defualt", for = "windows", orphan = true },
	{ run = 'cmd /c "%USERPROFILE%\.files\shell\cmd\bin\cmds\open_new_termtab.cmd" -e %1', desc = "View info in TermTab", for = "windows" },
	{ run = 'cmd /c "%USERPROFILE%\.files\shell\cmd\bin\cmds\open_new_termtab.cmd" -e -w %1', desc = "View info in TermTab (defaul workdir)", for = "windows" },

    # Para Android (Termux)
	{ run = 'termux-open "$1"', desc = "Open by default", for = "android" },

    # Para MacOS
	{ run = 'open "$@"', desc = "Open by default", for = "macos" },

    # Para Linux y Unix
	{ run = 'xdg-open "$1"', desc = "Open by default", for = "linux" },
	{ run = '${HOME}/.local/bin/open_new_termtab -e "$1"', desc = "View info in TermTab", for = "linux" },
	{ run = '${HOME}/.local/bin/open_new_termtab -e -w "$1"', desc = "View info in TermTab (default workdir)", for = "linux" },
]

reveal = [
    # Para Windows
	{ run = 'explorer /select,%1', desc = "Reveal by default", for = "windows", orphan = true },

    # Para Android (Termux)
	{ run = 'termux-open "$1"', desc = "Reveal by default", for = "android" },

    # Para MacOS
	{ run = 'open -R "$1"', desc = "Reveal by default", for = "macos" },

    # Para Linux y Unix
	{ run = 'xdg-open "$1"', desc = "Reveal by default", for = "linux" },
	{ run = '${HOME}/.local/bin/open_new_termtab "$1"', desc = "Go Parent Folder in TermTab", for = "linux" },
	{ run = 'nautilus --select "$1" &', desc = "Open in Explorer", for = "linux", orphan = true },
	{ run = 'clear; exiftool "$1"; echo "Press enter to exit"; read _', desc = "Show EXIF", for = "unix", block = true },
]

edit_txt = [
    # Para Windows
	{ run = '%EDITOR% %*', desc = "Edit %EDITOR%", for = "windows", block = true },
	{ run = 'cmd /c "%USERPROFILE%\.files\shell\cmd\bin\cmds\open_new_termtab.cmd" -e %1', desc = "Edit %EDITOR% in TermTab", for = "windows" },
	{ run = 'cmd /c "%USERPROFILE%\.files\shell\cmd\bin\cmds\open_new_termtab.cmd" -e -w %1', desc = "Edit %EDITOR% in TermTab (default workdir)", for = "windows" },
	{ run = 'code %*', desc = "Edit wtih VSCode", for = "windows", orphan = true },

    # Para Android (Termux)
    # Para MacOS

    # Para Linux y Unix
	{ run = '${EDITOR:-vim} "$@"', desc = "Edit $EDITOR", for = "unix", block = true },
	{ run = '${HOME}/.local/bin/open_new_termtab -e "$1"', desc = "Edit $EDITOR in TermTab", for = "linux" },
	{ run = '${HOME}/.local/bin/open_new_termtab -e -w "$1"', desc = "Edit $EDITOR in TermTab (defaul workdir)", for = "linux" },
	{ run = 'code "$@"', desc = "Edit wtih VSCode", for = "unix", orphan = true },
]

edit_img = [
    # Para Windows

    # Para Android (Termux)

    # Para MacOS

    # Para Linux y Unix
	{ run = 'krita "$1"', desc = "Open by Krita", for = "linux" },
	{ run = 'gimp "$1"', desc = "Open by Gimp", for = "linux" },
]

play = [
    # Para Windows
	{ run = 'mediainfo %1 & pause', block = true, desc = "Show media info", for = "windows" },

    # Para Android (Termux)

    # Para MacOS

    # Para Linux y Unix
	{ run = 'mediainfo "$1"; echo "Press enter to exit"; read _', block = true, desc = "Show media info", for = "unix" },
]

extract = [
	{ run = "ya pub extract --list %s", desc = "Extract here" },
]

download = [
	{ run = "ya emit download --open %S", desc = "Download and open" },
	{ run = "ya emit download %S", desc = "Download" },
]



[open]
rules = [

	# Folder> Folder en Unix (Linux)
	{ mime = "inode/directory", use = [ "open_folder" ] },

	# Folder> Folder en Windows
	{ mime = "folder/local", use = [ "open_folder" ] },

    # File> Draw.IO (xml file that should be treated as binary)
    { url = "*.drawio", use = [ "open_file", "reveal" ] },

	# File> Text
	{ mime = "text/*", use = [ "edit_txt", "reveal" ] },

	# File> Empty file (new file create, for example, with 'touch')
	{ mime = "inode/empty", use = [ "edit_txt", "reveal" ] },

	# File> JSON
	{ mime = "application/{json,ndjson}", use = [ "edit_txt", "reveal" ] },
	{ mime = "*/javascript", use = [ "edit_txt", "reveal" ] },

	# File> Image
	{ mime = "image/*", use = [ "open_file", "edit_img", "reveal" ] },

	# File> Media
	{ mime = "{audio,video}/*", use = [ "open_file", "play", "reveal" ] },

	# File> Compressed file
	{ mime = "application/{zip,rar,7z*,tar,gzip,xz,zstd,bzip*,lzma,compress,archive,cpio,arj,xar,ms-cab*}", use = [ "extract", "reveal" ] },

    # File> Office document
	{ mime = "application/{msword,ms-excel,ms-powerpoint}", use = [ "open_file", "reveal" ] },
	{ mime = "application/openxmlformats-officedocument.wordprocessingml.document", use = [ "open_file", "reveal" ] },
	{ mime = "application/openxmlformats-officedocument.spreadsheetml.sheet", use = [ "open_file", "reveal" ] },
	{ mime = "application/openxmlformats-officedocument.presentationml.presentation", use = [ "open_file", "reveal" ] },

	# Generic> Virtual file system
	{ mime = "vfs/{absent,stale}", use = "download" },

	# Generic> Fallback
	{ url = "*", use = [ "open_file", "reveal" ] },

]
